
#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда  
    
#Область ОбработчикиСобытий

Процедура ОбработкаПроверкиЗаполнения(Отказ, ПроверяемыеРеквизиты)
    
    Для каждого Строка Из ОтпускаСотрудников Цикл   
        
        Если ЗначениеЗаполнено (Строка.ДатаНачала) И ЗначениеЗаполнено(Строка.ДатаОкончания) Тогда 
            Если Строка.ДатаНачала > Строка.ДатаОкончания Тогда  
                ОбщегоНазначения.СообщитьПользователю(СтрШаблон("Неверно заполнен период в строке №%1", Строка.НомерСтроки)); 
                Отказ = Истина; 
            КонецЕсли; 
        КонецЕсли; 
       
    КонецЦикла;
    
КонецПроцедуры

Процедура ОбработкаПроведения(Отказ, РежимПроведения)
	
	Набор = РегистрыСведений.ВКМ_ГрафикиОтпусков.СоздатьНаборЗаписей(); 
	Сутки = 60*60*24; 
	
	Для каждого Строка Из ОтпускаСотрудников Цикл
	    ДеньПлан = Строка.ДатаНачала; 
		Пока ДеньПлан < Строка.ДатаОкончания +1 Цикл
		   НоваяЗапись = Набор.Добавить(); 
		   НоваяЗапись.Дата = ДеньПлан; 
		   НоваяЗапись.Сотрудник = Строка.Сотрудник; 
		   НоваяЗапись.Значение = 1; 
		   ДеньПлан = ДеньПлан + Сутки; 
		КонецЦикла;
	КонецЦикла;    
	
	Набор.Записать(); 
	
КонецПроцедуры

#КонецОбласти

#КонецЕсли